<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>キャリア市場ダッシュボード | Career Horizon</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
  <script defer src="scripts/site.js"></script>
  <script defer src="dashboard.js"></script>
</head>
<body data-page="dashboard">
  <a class="skip-link" href="#main">コンテンツへスキップ</a>
  <header class="header">
    <nav class="nav" aria-label="メインメニュー">
      <div class="nav-brand"><a href="index.html">Career Horizon</a></div>
      <button class="nav-toggle" id="mobile-menu" type="button" aria-expanded="false" aria-controls="primary-navigation">
        <span class="sr-only">メニューを開閉</span>
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </button>
      <ul class="nav-menu" id="primary-navigation">
        <li><a class="nav-link" data-nav="dashboard" href="index.html">ダッシュボード</a></li>
        <li><a class="nav-link" data-nav="news" href="news.html">ニュース</a></li>
        <li><a class="nav-link" data-nav="companies" href="companies.html">企業研究</a></li>
        <li><a class="nav-link" data-nav="resources" href="resources.html">リソース</a></li>
        <li><a class="nav-link" data-nav="tools" href="tools.html">ツール</a></li>
        <li><a class="nav-link" data-nav="glossary" href="glossary.html">用語集</a></li>
      </ul>
    </nav>
  </header>

  <main class="main-content" id="main">
    <section class="page-intro" aria-labelledby="dashboard-title">
      <p class="eyebrow">MONTHLY UPDATE</p>
      <h1 class="page-title" id="dashboard-title">転職市場 KPI ダッシュボード</h1>
      <p class="lead">公開統計・求人データ・転職サービスの指標を集約し、採用とキャリアの意思決定に必要な数値を 1 ページで確認できます。</p>
      <p class="update-time" aria-live="polite">最終更新: <span id="lastUpdated">読込中...</span></p>
      <aside class="data-sources" aria-label="参照元">
        <h2>データソース</h2>
        <ul id="dataSourceList" class="data-source-list">
          <li>統計データを読み込み中...</li>
        </ul>
        <p class="muted small-text">?? 各カードのアイコンから指標の定義を確認できます。</p>
      </aside>
      <div class="header-actions">
        <button class="view-source-btn" type="button" data-modal-trigger="definition-modal">?? 指標の定義</button>
        <a class="view-source-btn" href="data/kpi.json" download>?? JSON をダウンロード</a>
      </div>
    </section>

    <section class="filter-panel" aria-labelledby="filter-heading">
      <div class="section-header">
        <h2 id="filter-heading">対象を絞り込む</h2>
        <p>業種・地域・経験年数を選ぶと KPI とチャートが更新されます。設定はブラウザに保存されます。</p>
      </div>
      <form id="dashboard-filters" class="filter-form" data-autosave="dashboardFilters">
        <label class="filter-control">
          <span>業種</span>
          <select name="industry" id="filter-industry" aria-label="業種">
            <option value="all">全体平均</option>
            <option value="it">IT・通信</option>
            <option value="finance">金融・保険</option>
            <option value="manufacturing">製造</option>
            <option value="services">サービス</option>
            <option value="consulting">コンサルティング</option>
          </select>
        </label>
        <label class="filter-control">
          <span>地域</span>
          <select name="region" id="filter-region" aria-label="地域">
            <option value="all">全国</option>
            <option value="kanto">関東</option>
            <option value="kansai">関西</option>
            <option value="chubu">中部</option>
          </select>
        </label>
        <label class="filter-control">
          <span>経験年数</span>
          <select name="experience" id="filter-experience" aria-label="経験年数">
            <option value="all">全体</option>
            <option value="junior">20代</option>
            <option value="mid">30代</option>
            <option value="senior">40代</option>
          </select>
        </label>
        <div class="filter-actions">
          <button class="primary-btn" type="submit">条件を適用</button>
          <button class="ghost-btn" type="button" id="reset-filters">リセット</button>
        </div>
      </form>
    </section>

    <section class="kpi-section" aria-labelledby="kpi-heading">
      <div class="section-header">
        <h2 id="kpi-heading">主要 KPI</h2>
      </div>
      <div class="kpi-grid">
        <article class="kpi-card" data-metric="jobRatio">
          <header class="kpi-header">
            <div>
              <h3>有効求人倍率</h3>
              <p class="kpi-meta">全国 / 業種別</p>
            </div>
            <button class="info-button" type="button" data-definition="jobRatio" aria-label="有効求人倍率の定義">??</button>
          </header>
          <p class="kpi-value" data-field="value">--</p>
          <p class="kpi-change" data-field="change">--</p>
          <p class="kpi-footnote" data-field="note">前年同月比 --</p>
        </article>
        <article class="kpi-card" data-metric="unemploymentRate">
          <header class="kpi-header">
            <div>
              <h3>失業率</h3>
              <p class="kpi-meta">総務省 労働力調査</p>
            </div>
            <button class="info-button" type="button" data-definition="unemploymentRate" aria-label="失業率の定義">??</button>
          </header>
          <p class="kpi-value" data-field="value">--</p>
          <p class="kpi-change" data-field="change">--</p>
          <p class="kpi-footnote" data-field="note">前年同月比 --</p>
        </article>
        <article class="kpi-card" data-metric="salaryMedian">
          <header class="kpi-header">
            <div>
              <h3>中央値年収</h3>
              <p class="kpi-meta">業種 × 経験年数</p>
            </div>
            <button class="info-button" type="button" data-definition="salaryMedian" aria-label="中央値年収の定義">??</button>
          </header>
          <p class="kpi-value" data-field="value">--</p>
          <p class="kpi-change" data-field="change">--</p>
          <p class="kpi-footnote" data-field="note">P75 --</p>
        </article>
        <article class="kpi-card" data-metric="successRate">
          <header class="kpi-header">
            <div>
              <h3>転職成功率</h3>
              <p class="kpi-meta">経験レンジ別</p>
            </div>
            <button class="info-button" type="button" data-definition="successRate" aria-label="転職成功率の定義">??</button>
          </header>
          <p class="kpi-value" data-field="value">--</p>
          <p class="kpi-change" data-field="change">--</p>
          <p class="kpi-footnote" data-field="note">注: 選考完了母数ベース</p>
        </article>
        <article class="kpi-card" data-metric="newOpenings">
          <header class="kpi-header">
            <div>
              <h3>新規求人数</h3>
              <p class="kpi-meta">4 週移動平均</p>
            </div>
            <button class="info-button" type="button" data-definition="newOpenings" aria-label="新規求人数の定義">??</button>
          </header>
          <p class="kpi-value" data-field="value">--</p>
          <p class="kpi-change" data-field="change">--</p>
          <p class="kpi-footnote" data-field="note">前週比 --</p>
        </article>
      </div>
    </section>

    <section class="chart-section" aria-labelledby="chart-heading">
      <div class="section-header">
        <h2 id="chart-heading">トレンド</h2>
      </div>
      <div class="chart-grid">
        <figure class="chart-container">
          <h3>求人倍率推移（DODAを含む）</h3>
          <canvas id="jobRatioChart" aria-label="業種別の求人倍率推移" role="img"></canvas>
        </figure>
        <figure class="chart-container">
          <h3>地域別有効求人倍率</h3>
          <canvas id="regionJobRatioChart" aria-label="地域別求人倍率推移" role="img"></canvas>
        </figure>
        <figure class="chart-container">
          <h3>業種別中央値年収</h3>
          <canvas id="salaryChart" aria-label="業種別 年収分布" role="img"></canvas>
        </figure>
        <figure class="chart-container">
          <h3>年代別転職成功率</h3>
          <canvas id="ageChart" aria-label="年代別転職成功率" role="img"></canvas>
        </figure>
      </div>
    </section>
  </main>

  <div class="modal" id="definition-modal" role="dialog" aria-modal="true" aria-labelledby="definition-title" hidden>
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="definition-title">指標の定義</h3>
        <button class="close" type="button" data-close-modal aria-label="閉じる">&times;</button>
      </div>
      <div class="modal-body" id="definition-body">
        <p>読み込み中...</p>
      </div>
    </div>
  </div>
</body>
</html>
